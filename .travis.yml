dist: trusty
language: node_js
service_name: travis-pro
node_js:
- '8'
cache:
  directories:
  - node_modules
addons:
  apt:
    sources:
    - mysql-5.7-trusty
    packages:
    - mysql-server
    - mysql-client
before_install:
- echo -e "Host github.com\n\tHostName github.com\n\tUser git\n\tIdentityFile ~/.ssh/id_rsa_travis_ci\n"
  >> ~/.ssh/config
- openssl aes-256-cbc -K $encrypted_5fa70d14a19f_key -iv $encrypted_5fa70d14a19f_iv
  -in id_rsa_travis_ci.enc -out ./id_rsa_travis_ci -d
- mv ./id_rsa_travis_ci ~/.ssh/
- chmod 600 ~/.ssh/id_rsa_travis_ci
- ls -a ~/.ssh
- sudo mysql -e "use mysql; update user set authentication_string=PASSWORD('') where
  User='root'; update user set plugin='mysql_native_password';FLUSH PRIVILEGES;"
- sudo mysql_upgrade
- sudo service mysql restart
- mysql -e 'CREATE DATABASE IF NOT EXISTS qiibee;'
script:
- npm test
- npm run build
before_deploy:
- git add -f ./dist
deploy:
  - provider: elasticbeanstalk
    skip_cleanup: true
    access_key_id: AKIAIE4NIBVBAKOTWSQQ
    secret_access_key:
      secure: sFvyYkm/kW1ZYOtD/wlQWvRp+ArfFPtLWCswDK1CYXx0hE62L2L7ZTA5+G4ie6flIzfYYqjiCCexqhFP+fqeersLAgp8CzfQAbEIaGq1GWS2QPJANLEZqTW9UcS58/z41GXcm/OB+UgH+kB5Dcz0VMI5d/+tdn7Wndw9/SRPyhlZP50Ukf3zmuzGpgkVrzlGSqUfWbuF/gJk1ycLZuQwjXwnA6Kum+kneCm/QtzC74rnmgjP205loxJ34flBxZJT1wH8gmqcq+URdu8zVZ/eC9Bq94//qzxvwk8Szt814h9FiFUwsa0G2upZpUQpGWElda0EhNxjCyGxh+ImPz1ABhfm8FzNWLclYr3RQbzOnAaFTlPV2LyStiM4BIAvVmdowe0lngtRJgksctJ+IELq8v/6b4H+S70Xxo1jQMohj09sbWK/Xs2ejenBrdESAoEgl4l9KGisdD2a8ZrPxNXwHbtHiuGmuFfWOS9jboRcJIB10TAQ/XyM35jIjnGteH4hgprXR4dqEolxktcg9oIu+OBFX5AdsYdHtpfh7G9m2OZ9TD4jk3wwfbRvhLmLRM/yZHxjh4pVP2O5VaCIgdbYo7euhIp5R68YiX9kQsICKD0ZtYN6Ij5zAZE17F3zEpsLRr3H0LFS6XePUz9kf+bUJCf4AgSQ57DPar61Ng8cNqo=
    region: eu-central-1
    app: qbAPI
    env: qb-api-testing
    bucket_name: elasticbeanstalk-eu-central-1-233816796838
    on:
      repo: qiibee/qb-api
      branch: testing
  - provider: elasticbeanstalk
    skip_cleanup: true
    access_key_id: AKIAIE4NIBVBAKOTWSQQ
    secret_access_key:
      secure: sFvyYkm/kW1ZYOtD/wlQWvRp+ArfFPtLWCswDK1CYXx0hE62L2L7ZTA5+G4ie6flIzfYYqjiCCexqhFP+fqeersLAgp8CzfQAbEIaGq1GWS2QPJANLEZqTW9UcS58/z41GXcm/OB+UgH+kB5Dcz0VMI5d/+tdn7Wndw9/SRPyhlZP50Ukf3zmuzGpgkVrzlGSqUfWbuF/gJk1ycLZuQwjXwnA6Kum+kneCm/QtzC74rnmgjP205loxJ34flBxZJT1wH8gmqcq+URdu8zVZ/eC9Bq94//qzxvwk8Szt814h9FiFUwsa0G2upZpUQpGWElda0EhNxjCyGxh+ImPz1ABhfm8FzNWLclYr3RQbzOnAaFTlPV2LyStiM4BIAvVmdowe0lngtRJgksctJ+IELq8v/6b4H+S70Xxo1jQMohj09sbWK/Xs2ejenBrdESAoEgl4l9KGisdD2a8ZrPxNXwHbtHiuGmuFfWOS9jboRcJIB10TAQ/XyM35jIjnGteH4hgprXR4dqEolxktcg9oIu+OBFX5AdsYdHtpfh7G9m2OZ9TD4jk3wwfbRvhLmLRM/yZHxjh4pVP2O5VaCIgdbYo7euhIp5R68YiX9kQsICKD0ZtYN6Ij5zAZE17F3zEpsLRr3H0LFS6XePUz9kf+bUJCf4AgSQ57DPar61Ng8cNqo=
    region: eu-central-1
    app: qbAPI
    env: qb-api-production
    bucket_name: elasticbeanstalk-eu-central-1-233816796838
    on:
      repo: qiibee/qb-api
      branch: production
notifications:
  slack:
    secure: ZzpOM0BQ2nwrisHjaoELCtcykyc8tMG9qVVQq8SJjoCHlDN9HwTMZZ+VQfAAUr9k5hbxFEir8p+r47a6kyAGA3XJ9KxORUI65TP71IETVlIS+Ud5nZZmte7aGFOi4WRTSbuLzG5hYY+HGiDFZHMybf2ocrQlidqtgw8OB01cLM9e1GkQtg/DL5RNpyzPVzfB2KC6XnZ0B1Pa2uQzxsC+KRFzLXRVN9jqFQewIrtCMtYm7qMy4+pRhNTXHrE6OWj0GKrBrsGj3WizUqTABo2UwF9ovf8yZldifqlZLHfT6anyrK0tMGE+FuMJ2gMN92JsSZt7CHW7Q/cyVEVdib/X0GhpductZmayTEuHnI9UoA162kY4sS5VXELUHUX7netctGeTsHEQrGnRg6Zvx23nkOcisVlenfIAr88suYMkzYQ2FxJD+iW441Wn8k7xx8r3v0wj5pGe/HD3cWtCA9MJsP5M6ctuGXXVQ2PN3H9J33bodqsSfKPjb8OYPUDVQUG4J5HSioopIGh9i3736v3+OMRId7lr778B9WbR1dYXAzbKoeW/thtDcfierMsYQm8kXe22LIHZR1cC3D26lmxtXOYFCemYjDHYV3+H5qebwsANJQF3P+oz/SZSBjHs7RyxYUvf6Qk682cBOoqlc7OZuu23YXhymhXwlyXd4+lXyTo=
